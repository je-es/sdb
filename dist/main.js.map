{"version":3,"sources":["../src/main.ts"],"names":["DB","path","Database","schema","sql","index","indexSql","tableName","table","conditions","whereConditions","column","value","id","data","lastId","callback","error","params","builder","self","columns","condition","whereClauses","cond","placeholders","val","clause","direction","count","values","setClauses","col","updateValues","whereClause","result","parts","i","results","columnDefs","def","name","type","integer","text","real","blob","numeric","primaryKey","autoIncrement","notNull","unique","defaultValue","references"],"mappings":"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","file":"main.js","sourcesContent":["// src/main.ts\n//\n// Developed with ❤️ by Maysara.\n\n\n\n// ╔════════════════════════════════════════ PACK ════════════════════════════════════════╗\n\n    import { Database } from 'bun:sqlite';\n    import * as types from './types.d';\n    export * from './types.d';\n\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\n\n\n\n// ╔════════════════════════════════════════ CORE ════════════════════════════════════════╗\n\n    export class DB {\n\n        // ┌──────────────────────────────── INIT ──────────────────────────────┐\n\n            private db              : Database;\n            private schemas         : Map<string, types.TableSchema>;\n            private currentQuery    : string = '';\n            private currentParams   : types.SqlValue[] = [];\n\n        // └────────────────────────────────────────────────────────────────────┘\n\n\n        // ┌──────────────────────────────── CORE ──────────────────────────────┐\n\n            constructor(path: string = ':memory:') {\n                this.schemas = new Map;\n                this.db = new Database(path);\n                this.db.exec('PRAGMA foreign_keys = ON');\n            }\n\n            close(): void {\n                this.db.close();\n            }\n\n            // ════════ Schema Management ════════\n            defineSchema(schema: types.TableSchema): void {\n                this.schemas.set(schema.name, schema);\n                const sql = this.generateCreateTableSQL(schema);\n                this.db.exec(sql);\n\n                // Create indexes\n                if (schema.indexes) {\n                    for (const index of schema.indexes) {\n                        const uniqueStr = index.unique ? 'UNIQUE' : '';\n                        const indexSql = `CREATE ${uniqueStr} INDEX IF NOT EXISTS ${index.name} ON ${schema.name} (${index.columns.join(', ')})`;\n                        this.db.exec(indexSql);\n                    }\n                }\n            }\n\n            getSchema(tableName: string): types.TableSchema | undefined {\n                return this.schemas.get(tableName);\n            }\n\n            listTables(): string[] {\n                const result = this.db.query(\"SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%'\").all();\n                return result.map((r: unknown) => (r as types.TableRow).name);\n            }\n\n            dropTable(tableName: string): void {\n                this.db.exec(`DROP TABLE IF EXISTS ${tableName}`);\n                this.schemas.delete(tableName);\n            }\n\n            // ════════ Query Builder ════════\n            query(): types.QueryBuilder {\n                this.reset();\n                return this.createQueryBuilder();\n            }\n\n            // ════════ Quick Operations ════════\n            find(table: string, conditions: Record<string, types.SqlValue>): unknown[] {\n                const whereConditions: types.WhereCondition[] = Object.entries(conditions).map(([column, value]) => ({\n                    column,\n                    operator: '=' as const,\n                    value\n                }));\n\n                return this.query()\n                    .select()\n                    .from(table)\n                    .where(whereConditions)\n                    .execute();\n            }\n\n            findOne(table: string, conditions: Record<string, types.SqlValue>): unknown | null {\n                return this.query()\n                    .select()\n                    .from(table)\n                    .where(Object.entries(conditions).map(([column, value]) => ({\n                        column,\n                        operator: '=' as const,\n                        value\n                    })))\n                    .limit(1)\n                    .executeOne();\n            }\n\n            findById(table: string, id: number | string): unknown | null {\n                return this.findOne(table, { id });\n            }\n\n            all(table: string): unknown[] {\n                return this.query().select().from(table).execute();\n            }\n\n            insert(table: string, data: Record<string, types.SqlValue>): unknown {\n                this.query().insert(table, data).execute();\n\n                // Return inserted row\n                const lastId = this.db.query('SELECT last_insert_rowid() as id').get() as types.LastIdRow;\n                return this.findById(table, lastId.id);\n            }\n\n            update(table: string, id: number | string, data: Record<string, types.SqlValue>): unknown | null {\n                this.query()\n                    .update(table, data)\n                    .where({ column: 'id', operator: '=', value: id })\n                    .execute();\n\n                return this.findById(table, id);\n            }\n\n            delete(table: string, id: number | string): boolean {\n                this.query()\n                    .delete(table)\n                    .where({ column: 'id', operator: '=', value: id })\n                    .execute();\n\n                return true;\n            }\n\n            // ════════ Transactions ════════\n            transaction(callback: (db: DB) => void): void {\n                this.db.exec('BEGIN TRANSACTION');\n                try {\n                    callback(this);\n                    this.db.exec('COMMIT');\n                } catch (error) {\n                    this.db.exec('ROLLBACK');\n                    throw error;\n                }\n            }\n\n            // ════════ Raw SQL ════════\n            exec(sql: string): void {\n                this.db.exec(sql);\n            }\n\n            raw(sql: string, params: types.SqlValue[] = []): unknown[] {\n                const stmt = this.db.query(sql);\n                return stmt.all(...params) as unknown[];\n            }\n\n            rawOne(sql: string, params: types.SqlValue[] = []): unknown | null {\n                const stmt = this.db.query(sql);\n                return stmt.get(...params) as unknown | null;\n            }\n\n        // └────────────────────────────────────────────────────────────────────┘\n\n\n        // ┌──────────────────────────────── HELP ──────────────────────────────┐\n\n            private reset(): void {\n                this.currentQuery = '';\n                this.currentParams = [];\n            }\n\n            private createQueryBuilder(): types.QueryBuilder {\n                const builder: types.QueryBuilderInternal & Partial<types.QueryBuilder> & { buildWhereClause?: () => string } = {\n                    _select: ['*'],\n                    _from: '',\n                    _where: [],\n                    _orderBy: '',\n                    _limit: null,\n                    _offset: null,\n                    _isInsert: false,\n                    _isUpdate: false,\n                    _isDelete: false,\n                    _insertData: null,\n                    _updateData: null\n                };\n\n                // Bind methods to this DB instance\n                // eslint-disable-next-line @typescript-eslint/no-this-alias\n                const self = this;\n\n                builder.select = function(columns?: string[]): types.QueryBuilder {\n                    this._select = columns || ['*'];\n                    return this as unknown as types.QueryBuilder;\n                };\n\n                builder.from = function(table: string): types.QueryBuilder {\n                    this._from = table;\n                    return this as unknown as types.QueryBuilder;\n                };\n\n                builder.where = function(condition: types.WhereCondition | types.WhereCondition[]): types.QueryBuilder {\n                    const conditions = Array.isArray(condition) ? condition : [condition];\n\n                    const whereClauses = conditions.map(cond => {\n                        if (cond.operator === 'IS NULL' || cond.operator === 'IS NOT NULL') {\n                            return `${cond.column} ${cond.operator}`;\n                        } else if (cond.operator === 'IN' && Array.isArray(cond.value)) {\n                            const placeholders = cond.value.map(() => '?').join(', ');\n                            // Spread array values into params\n                            cond.value.forEach(val => {\n                                self.currentParams.push(val as types.SqlValue);\n                            });\n                            return `${cond.column} IN (${placeholders})`;\n                        } else {\n                            self.currentParams.push(cond.value as types.SqlValue);\n                            return `${cond.column} ${cond.operator} ?`;\n                        }\n                    });\n\n                    this._where.push(...whereClauses);\n                    return this as unknown as types.QueryBuilder;\n                };\n\n                builder.and = function(condition: types.WhereCondition): types.QueryBuilder {\n                    return this.where!(condition);\n                };\n\n                builder.or = function(condition: types.WhereCondition): types.QueryBuilder {\n                    let clause = '';\n                    if (condition.operator === 'IS NULL' || condition.operator === 'IS NOT NULL') {\n                        clause = `${condition.column} ${condition.operator}`;\n                    } else if (condition.operator === 'IN' && Array.isArray(condition.value)) {\n                        const placeholders = condition.value.map(() => '?').join(', ');\n                        // Spread array values into params\n                        condition.value.forEach(val => {\n                            self.currentParams.push(val as types.SqlValue);\n                        });\n                        clause = `${condition.column} IN (${placeholders})`;\n                    } else {\n                        self.currentParams.push(condition.value as types.SqlValue);\n                        clause = `${condition.column} ${condition.operator} ?`;\n                    }\n\n                    // Add OR prefix to the clause itself\n                    this._where.push(`OR ${clause}`);\n                    return this as unknown as types.QueryBuilder;\n                };\n\n                builder.orderBy = function(column: string, direction: 'ASC' | 'DESC' = 'ASC'): types.QueryBuilder {\n                    this._orderBy = `ORDER BY ${column} ${direction}`;\n                    return this as unknown as types.QueryBuilder;\n                };\n\n                builder.limit = function(count: number): types.QueryBuilder {\n                    this._limit = count;\n                    return this as unknown as types.QueryBuilder;\n                };\n\n                builder.offset = function(count: number): types.QueryBuilder {\n                    this._offset = count;\n                    return this as unknown as types.QueryBuilder;\n                };\n\n                builder.insert = function(table: string, data: Record<string, types.SqlValue>): types.QueryBuilder {\n                    this._isInsert = true;\n                    this._from = table;\n                    this._insertData = data;\n                    return this as unknown as types.QueryBuilder;\n                };\n\n                builder.update = function(table: string, data: Record<string, types.SqlValue>): types.QueryBuilder {\n                    this._isUpdate = true;\n                    this._from = table;\n                    this._updateData = data;\n                    return this as unknown as types.QueryBuilder;\n                };\n\n                builder.delete = function(table: string): types.QueryBuilder {\n                    this._isDelete = true;\n                    this._from = table;\n                    return this as unknown as types.QueryBuilder;\n                };\n\n                builder.raw = function(sql: string, params: types.SqlValue[] = []): types.QueryBuilder {\n                    self.currentQuery = sql;\n                    self.currentParams = params;\n                    return this as unknown as types.QueryBuilder;\n                };\n\n                builder.execute = function(): unknown[] {\n                    let sql = '';\n\n                    if (this._isInsert && this._insertData) {\n                        const columns = Object.keys(this._insertData);\n                        const values = Object.values(this._insertData);\n\n                        // Handle empty insert (all defaults)\n                        if (columns.length === 0) {\n                            sql = `INSERT INTO ${this._from} DEFAULT VALUES`;\n                            self.currentParams = [];\n                        } else {\n                            const placeholders = columns.map(() => '?').join(', ');\n                            sql = `INSERT INTO ${this._from} (${columns.join(', ')}) VALUES (${placeholders})`;\n                            self.currentParams = values;\n                        }\n                    } else if (this._isUpdate && this._updateData) {\n                        const setClauses = Object.keys(this._updateData).map(col => `${col} = ?`);\n                        const updateValues = Object.values(this._updateData);\n                        self.currentParams = [...updateValues, ...self.currentParams] as types.SqlValue[];\n                        sql = `UPDATE ${this._from} SET ${setClauses.join(', ')}`;\n\n                        if (this._where.length > 0) {\n                            // Build WHERE clause properly handling OR conditions\n                            const whereClause = this.buildWhereClause!();\n                            sql += ` WHERE ${whereClause}`;\n                        }\n                    } else if (this._isDelete) {\n                        sql = `DELETE FROM ${this._from}`;\n\n                        if (this._where.length > 0) {\n                            // Build WHERE clause properly handling OR conditions\n                            const whereClause = this.buildWhereClause!();\n                            sql += ` WHERE ${whereClause}`;\n                        }\n                    } else {\n                        // SELECT query or raw query\n                        if (self.currentQuery) {\n                            sql = self.currentQuery;\n                        } else {\n                            sql = `SELECT ${this._select.join(', ')} FROM ${this._from}`;\n\n                            if (this._where.length > 0) {\n                                // Build WHERE clause properly handling OR conditions\n                                const whereClause = this.buildWhereClause!();\n                                sql += ` WHERE ${whereClause}`;\n                            }\n\n                            if (this._orderBy) {\n                                sql += ` ${this._orderBy}`;\n                            }\n\n                            if (this._limit !== null) {\n                                sql += ` LIMIT ${this._limit}`;\n                            }\n\n                            // OFFSET requires LIMIT in SQLite\n                            if (this._offset !== null) {\n                                if (this._limit === null) {\n                                    // Add a very large limit if offset is used without limit\n                                    sql += ` LIMIT -1`;\n                                }\n                                sql += ` OFFSET ${this._offset}`;\n                            }\n                        }\n                    }\n\n                    const stmt = self.db.query(sql);\n                    const result = stmt.all(...self.currentParams) as unknown[];\n                    self.reset();\n                    return result;\n                };\n\n                builder.buildWhereClause = function(): string {\n                    const parts: string[] = [];\n                    for (let i = 0; i < this._where.length; i++) {\n                        const clause = this._where[i];\n                        if (clause.startsWith('OR ')) {\n                            parts.push('OR');\n                            parts.push(clause.substring(3)); // Remove 'OR ' prefix\n                        } else {\n                            if (i > 0 && !this._where[i - 1].startsWith('OR ')) {\n                                parts.push('AND');\n                            }\n                            parts.push(clause);\n                        }\n                    }\n                    return parts.join(' ');\n                };\n\n                builder.executeOne = function(): unknown | null {\n                    const results = this.execute!();\n                    return results.length > 0 ? results[0] : null;\n                };\n\n                builder.executeRaw = function(sql: string, params: types.SqlValue[] = []): unknown[] {\n                    const stmt = self.db.query(sql);\n                    const result = stmt.all(...params) as unknown[];\n                    return result;\n                };\n\n                return builder as types.QueryBuilder;\n            }\n\n            private generateCreateTableSQL(schema: types.TableSchema): string {\n                const columnDefs = schema.columns.map(col => {\n                    let def = `${col.name} ${col.type}`;\n\n                    if (col.primaryKey) {\n                        def += ' PRIMARY KEY';\n                        if (col.autoIncrement) {\n                            def += ' AUTOINCREMENT';\n                        }\n                    }\n\n                    if (col.notNull && !col.primaryKey) {\n                        def += ' NOT NULL';\n                    }\n\n                    if (col.unique) {\n                        def += ' UNIQUE';\n                    }\n\n                    if (col.default !== undefined) {\n                        if (typeof col.default === 'string') {\n                            def += ` DEFAULT '${col.default}'`;\n                        } else if (col.default === null) {\n                            def += ' DEFAULT NULL';\n                        } else {\n                            def += ` DEFAULT ${col.default}`;\n                        }\n                    }\n\n                    if (col.references) {\n                        def += ` REFERENCES ${col.references.table}(${col.references.column})`;\n                    }\n\n                    return def;\n                });\n\n                return `CREATE TABLE IF NOT EXISTS ${schema.name} (${columnDefs.join(', ')})`;\n            }\n\n        // └────────────────────────────────────────────────────────────────────┘\n\n    }\n\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\n\n\n\n// ╔════════════════════════════════════════ HELP ════════════════════════════════════════╗\n\n    // ════════ Schema Builder Helpers ════════\n    export function table(name: string, columns: types.ColumnDefinition[]): types.TableSchema {\n        return { name, columns };\n    }\n\n    export function column(name: string, type: types.ColumnType): types.ColumnDefinition {\n        return { name, type };\n    }\n\n    export function integer(name: string): types.ColumnDefinition {\n        return { name, type: 'INTEGER' };\n    }\n\n    export function text(name: string): types.ColumnDefinition {\n        return { name, type: 'TEXT' };\n    }\n\n    export function real(name: string): types.ColumnDefinition {\n        return { name, type: 'REAL' };\n    }\n\n    export function blob(name: string): types.ColumnDefinition {\n        return { name, type: 'BLOB' };\n    }\n\n    export function numeric(name: string): types.ColumnDefinition {\n        return { name, type: 'NUMERIC' };\n    }\n\n    // ════════ Column Modifiers ════════\n    export function primaryKey(col: types.ColumnDefinition, autoIncrement = false): types.ColumnDefinition {\n        return { ...col, primaryKey: true, autoIncrement };\n    }\n\n    export function notNull(col: types.ColumnDefinition): types.ColumnDefinition {\n        return { ...col, notNull: true };\n    }\n\n    export function unique(col: types.ColumnDefinition): types.ColumnDefinition {\n        return { ...col, unique: true };\n    }\n\n    export function defaultValue(col: types.ColumnDefinition, value: types.SqlValue): types.ColumnDefinition {\n        return { ...col, default: value };\n    }\n\n    export function references(col: types.ColumnDefinition, table: string, column: string): types.ColumnDefinition {\n        return { ...col, references: { table, column } };\n    }\n\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝"]}